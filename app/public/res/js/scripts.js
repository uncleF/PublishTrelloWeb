!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a){return Array.prototype.indexOf.call(C,a)}function e(a){return a.className.indexOf("js-autocompleteOption")>-1}function f(){var a=F.scrollTop,b=F.getAttribute("data-height")-0;return b||(b=F.offsetHeight-C[0].offsetHeight,F.setAttribute("data-height",b)),{scroll:a,height:b}}function g(a){var b=a.getAttribute("data-position")-0;return b||(b=a.offsetTop,a.setAttribute("data-position",b)),b}function h(){requestAnimationFrame(function(){var a=C[E],b=g(a),c=f();b<=c.scroll?a.scrollIntoView(!0):b>=c.scroll+c.height&&a.scrollIntoView(!1)})}function i(a){E>-1&&(C[E].className=C[E].className.replace(" js-autocompleteOption-is-highlighted","")),E=a,C[E].className+=" js-autocompleteOption-is-highlighted"}function j(){A.value=C[E].href,H.trigger(A,"change",!0)}function k(a){i(a),h()}function l(a){k(a),j()}function m(a){a.preventDefault(),l(E>0?E-1:D-1)}function n(a){a.preventDefault(),l(E>-1&&D-1>E?E+1:0)}function o(a){var b=a.target;e(b)&&l(d(b))}function p(a){a.preventDefault(),u(),H.trigger(A,"change")}function q(a){var b=a.keyCode;return 38===b?void m(a):40===b?void n(a):13===b?void p(a):void 0}function r(){F.className="autocomplete autocomplete-is-active"}function s(){F.className="autocomplete"}function t(){I&&!J&&(J=!0,r(),H.unbind(A,"keydown",x),H.bind(A,"keydown",q))}function u(a){J&&(J=!1,s(),H.unbind(A,"keydown",q),H.bind(A,"keydown",x))}function v(a){a.preventDefault()}function w(){C=document.getElementsByClassName("js-autocompleteOption"),D=C.length,I=!0}function x(a){40===a.keyCode&&(a.preventDefault(),t())}function y(){I=!1,G.update()}function z(a,b){var c="oninput"in window?"input":"keyup";A=a,B=b,G.init(F,B),H.bind(A,"focus",t),H.bind(A,"blur",u),H.bind(A,c,u),H.bind(F,"mouseover",o),H.bind(F,"click",v),H.bind(window,"gotboards",w)}var A,B,C,D,E,F=document.getElementById("autocomplete"),G=a("./autocompleteUpdate"),H=a("./patterns/tx-event.js"),I=!1,J=!1;c.init=z,c.activate=t,c.deactivate=u,c.reset=y},{"./autocompleteUpdate":2,"./patterns/tx-event.js":7}],2:[function(a,b,c){"use strict";function d(a){var b="";return a.starred&&(b="js-autocompleteOption-is-starred"),'<li class="js-autocompleteItem"><a href="'+a.shortUrl+'" class="js-autocompleteOption '+b+'">'+a.name+"</a></li>"}function e(){for(var a="",b=0,c=o.length;c>b;b+=1)a+=d(o[b]);l.insertAdjacentHTML("beforeend",a),q.trigger(window,"gotboards")}function f(a,b){p({method:"GET",uri:a},b)}function g(a,b){a?console.log(a):(Modernizr.localstorage&&(localStorage[r]=b.body),o=JSON.parse(b.body),e())}function h(){var a="https://api.trello.com/1/members/"+n+"/boards?key="+m.key()+"&token="+m.token()+"&fields=name,shortUrl&filter=open";Modernizr.localstorage&&localStorage[r]&&(o=JSON.parse(localStorage[r]),o&&e()),f(a,g)}function i(a,b){a?console.log(a):(n=JSON.parse(b.body).username,h())}function j(){var a="https://api.trello.com/1/tokens/"+m.token()+"/member?key="+m.key()+"&fields=username";f(a,i)}function k(a,b){l=a,m=b,j()}var l,m,n,o,p=a("browser-request"),q=a("./patterns/tx-event.js"),r="trello_boards_autocomplete";c.init=k,c.update=h},{"./patterns/tx-event.js":7,"browser-request":12}],3:[function(a,b,c){"use strict";function d(a){console.log("Service worker successfully installed with the scope of: "+a.scope)}function e(a){console.log("Failed to install service worker. "+a)}function f(){Modernizr.serviceworker&&navigator.serviceWorker.register("/service.js").then(d)["catch"](e)}c.init=f},{}],4:[function(a,b,c){"use strict";function d(){s.disabled=!0,s.className="download download-is-busy"}function e(){"download download-is-busy"!==s.className&&s.disabled&&"form form-is-validBoard"===q.className&&(t.html.checked||t.md.checked||t.pdf.checked||t.epub.checked)?s.disabled=!1:"download download-is-busy"===s.className||s.disabled||"form form-is-validBoard"===q.className&&(t.html.checked||t.md.checked||t.pdf.checked||t.epub.checked)||(s.disabled=!0)}function f(){""!==r.value?r.value.match(p.regExpURL())?q.className="form form-is-validBoard":q.className="form form-is-invalidBoard":q.className="form"}function g(){q.reset(),f(),s.className="download"}function h(a,b){g(),window.location="/download?dir="+a+"&file="+b}function i(){var a=v(q,{hash:!0});return a.board=a.board.replace(/http.*\/b\//g,"").replace(/\/.*/g,""),a.token=p.token(),a}function j(a,b){if(a||200!==b.statusCode)g(),w.show("Something went wrong!");else{var c=JSON.parse(b.responseText);c.hasOwnProperty("error")?(g(),w.show(c.error)):h(c.dir,c.file)}}function k(){var a=i();a.hasOwnProperty("token")&&a.token&&(d(),u({method:"POST",uri:"/generate",body:a,json:!0},j))}function l(){y.unbind(window,"gottoken",l),k()}function m(a){a.preventDefault(),p.authorized()?k():(y.bind(window,"gottoken",l),p.authorizeTrello())}function n(){x.init(r,p,p.regExpURL()),y.unbind(window,"authsuccess",n)}function o(a){var b="oninput"in window?"input":"keyup";p=a,w.init(),y.bind(q,"submit",m),y.bind(q,"change",e),y.bind(q,b,e),y.bind(r,"change",f),y.bind(r,b,f),p.authorized()?n():y.bind(window,"authsuccess",n)}var p,q=document.getElementById("form"),r=document.getElementById("board"),s=document.getElementById("download"),t={html:document.getElementById("html"),md:document.getElementById("md"),pdf:document.getElementById("pdf"),epub:document.getElementById("epub")},u=a("browser-request"),v=a("form-serialize"),w=a("./messages"),x=a("./autocomplete"),y=a("./patterns/tx-event.js");c.init=o},{"./autocomplete":1,"./messages":6,"./patterns/tx-event.js":7,"browser-request":12,"form-serialize":13}],5:[function(a,b,c){"use strict";function d(a){a&&a.preventDefault(),l.toggle()}function e(){"authHelp"===j.className?(j.className="authHelp authHelp-is-invisible",k.className="disclaimerIEbug disclaimerIEbug-is-invisible"):(j.className="authHelp",k.className="disclaimerIEbug")}function f(){m.bind(h,"click",l.toggle),m.bind(i,"click",d),m.bind(window,"authsuccess",e),m.bind(window,"authfailure",e)}var g=document.getElementById("help"),h=document.getElementById("closeHelp"),i=document.getElementById("helpToggle"),j=document.getElementById("authHelp"),k=document.getElementById("disclaimerIEbug"),l=a("./patterns/tx-overlay.js").init(g),m=a("./patterns/tx-event.js");c.init=f},{"./patterns/tx-event.js":7,"./patterns/tx-overlay.js":8}],6:[function(a,b,c){"use strict";function d(){k.bind(h,"click",j.toggle),k.bind(i,"click",j.toggle)}function e(a){g.textContent=a,j.toggle()}var f=document.getElementById("message"),g=document.getElementById("messageText"),h=document.getElementById("closeMessage"),i=document.getElementById("okMessage"),j=a("./patterns/tx-overlay.js").init(f),k=a("./patterns/tx-event.js");c.init=d,c.show=e},{"./patterns/tx-event.js":7,"./patterns/tx-overlay.js":8}],7:[function(a,b,c){"use strict";function d(a,b,c){document.addEventListener?a.addEventListener(b,c):a.attachEvent("on"+b,c)}function e(a,b,c){document.removeEventListener?a.removeEventListener(b,c):a.detachEvent("on"+b,c)}function f(a,b,c){c=c||!1;var d;document.createEvent?(d=document.createEvent("MouseEvents"),d.initEvent(b,c,!1),a.dispatchEvent(d)):(d=document.createEventObject(),a.fireEvent("on"+b,d))}c.bind=d,c.unbind=e,c.trigger=f},{}],8:[function(a,b,c){"use strict";function d(a){function b(a){var b=e.className;a&&a.preventDefault(),e.className=b.indexOf(g)>-1?b.replace(g,""):b+" "+g}function c(a){var c=a.target?a.target:a.srcElement;c.className.indexOf(g)>-1&&b(a)}function d(){a&&(e=a,g=e.className.split(" ")[0]+"-is-active",f.bind(e,"click",c))}var e,g;return d(),{toggle:b}}function e(a){return new d(a)}var f=a("./tx-event");c.init=e},{"./tx-event":7}],9:[function(a,b,c){"use strict";function d(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}c.polyfill=d},{}],10:[function(a,b,c){"use strict";function d(){u.trigger(window,"authsuccess")}function e(){u.trigger(window,"authfailure")}function f(){return z}function g(){return r}function h(){return v}function i(){return y}function j(a){var b;return a.origin!==x||a.source!==q?void e():(null!==(b=a.source)&&b.close(),null!==a.data&&/[0-9a-f]{64}/.test(a.data)?(r=a.data,d()):(r=null,e()),Modernizr.localstorage&&r?localStorage[w]=r:r||delete localStorage[w],u.trigger(window,"gottoken"),void u.unbind(window,"message",j))}function k(){u.bind(window,"message",j);var a=420,b=470,c=window.screenX+(window.innerWidth-a)/2,d=window.screenY+(window.innerHeight-b)/2,e=window.location,f=null!==(e=/^[a-z]+:\/\/[^\/]*/.exec(e))?e[0]:void 0;q=window.open("https://trello.com/1/authorize?response_type=token&key="+v+"&return_url="+f+"&callback_method=postMessage&scope=read&expiration=never&name=Publish%20Trello","trello","width="+a+",height="+b+",left="+c+",top="+d)}function l(){r=null,Modernizr.localstorage&&delete localStorage[w]}function m(){z=!0,s.className="authorization authorization-is-authorized"}function n(){z=!1,s.className="authorization authorization-is-unauthorized"}function o(a){a.preventDefault(),f()||k()}function p(){u.bind(s,"click",o),u.bind(t,"click",o),u.bind(window,"authsuccess",m),u.bind(window,"authfailure",n),Modernizr.localstorage&&localStorage[w]&&(r=localStorage[w],d())}var q,r,s=document.getElementById("authToggle"),t=document.getElementById("authToggleHelp"),u=a("./patterns/tx-event.js"),v="84e8362bd7d7fefaab5498e386897312",w="trello_token",x="https://trello.com",y=new RegExp(/(?:^(?:https?:\/\/)?|^(?:w{3}\.)?|^(?:https?:\/\/w{3}\.)?)trello\.com\/b\/.+/),z=!1;c.init=p,c.authorizeTrello=k,c.authorizeTrello=l,c.authorized=f,c.token=g,c.key=h,c.regExpURL=i},{"./patterns/tx-event.js":7}],11:[function(a,b,c){"use strict";!function(){function b(){g.polyfill(),c.init(),d.init(),e.init(d),f.init(e)}var c=a("./components/cache"),d=a("./components/help"),e=a("./components/trello"),f=a("./components/form"),g=a("./components/patterns/tx-rAF");b()}()},{"./components/cache":3,"./components/form":4,"./components/help":5,"./components/patterns/tx-rAF":9,"./components/trello":10}],12:[function(a,b,c){!function(a,d){"function"==typeof define&&define.amd?define([],d):"object"==typeof c?b.exports=d():a.returnExports=d()}(this,function(){function a(e,f){if("function"!=typeof f)throw new Error("Bad callback given: "+f);if(!e)throw new Error("No options given");var h=e.onResponse;if(e="string"==typeof e?{uri:e}:JSON.parse(JSON.stringify(e)),e.onResponse=h,e.verbose&&(a.log=d()),e.url&&(e.uri=e.url,delete e.url),!e.uri&&""!==e.uri)throw new Error("options.uri is a required argument");if("string"!=typeof e.uri)throw new Error("options.uri must be a string");for(var i=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],j=0;j<i.length;j++)if(e[i[j]])throw new Error("options."+i[j]+" is not supported");if(e.callback=f,e.method=e.method||"GET",e.headers=e.headers||{},e.body=e.body||null,e.timeout=e.timeout||a.DEFAULT_TIMEOUT,e.headers.host)throw new Error("Options.headers.host is not supported");e.json&&(e.headers.accept=e.headers.accept||"application/json","GET"!==e.method&&(e.headers["content-type"]="application/json"),"boolean"!=typeof e.json?e.body=JSON.stringify(e.json):"string"!=typeof e.body&&(e.body=JSON.stringify(e.body)));var k=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")};if(e.qs){var l="string"==typeof e.qs?e.qs:k(e.qs);-1!==e.uri.indexOf("?")?e.uri=e.uri+"&"+l:e.uri=e.uri+"?"+l}var m=function(a){var b={};b.boundry="-------------------------------"+Math.floor(1e9*Math.random());var c=[];for(var d in a)a.hasOwnProperty(d)&&c.push("--"+b.boundry+'\nContent-Disposition: form-data; name="'+d+'"\n\n'+a[d]+"\n");return c.push("--"+b.boundry+"--"),b.body=c.join(""),b.length=b.body.length,b.type="multipart/form-data; boundary="+b.boundry,b};if(e.form){if("string"==typeof e.form)throw"form name unsupported";if("POST"===e.method){var n=(e.encoding||"application/x-www-form-urlencoded").toLowerCase();switch(e.headers["content-type"]=n,n){case"application/x-www-form-urlencoded":e.body=k(e.form).replace(/%20/g,"+");break;case"multipart/form-data":var o=m(e.form);e.body=o.body,e.headers["content-type"]=o.type;break;default:throw new Error("unsupported encoding:"+n)}}}return e.onResponse=e.onResponse||c,e.onResponse===!0&&(e.onResponse=f,e.callback=c),!e.headers.authorization&&e.auth&&(e.headers.authorization="Basic "+g(e.auth.username+":"+e.auth.password)),b(e)}function b(b){function c(){l=!0;var c=new Error("ETIMEDOUT");return c.code="ETIMEDOUT",c.duration=b.timeout,a.log.error("Timeout",{id:k._id,milliseconds:b.timeout}),b.callback(c,k)}function d(c){if(l)return a.log.debug("Ignoring timed out state change",{state:k.readyState,id:k.id});if(a.log.debug("State change",{state:k.readyState,id:k.id,timed_out:l}),k.readyState===h.OPENED){a.log.debug("Request started",{id:k.id});for(var d in b.headers)k.setRequestHeader(d,b.headers[d])}else k.readyState===h.HEADERS_RECEIVED?e():k.readyState===h.LOADING?(e(),g()):k.readyState===h.DONE&&(e(),g(),i())}function e(){if(!p.response){if(p.response=!0,a.log.debug("Got response",{id:k.id,status:k.status}),clearTimeout(k.timeoutTimer),k.statusCode=k.status,m&&0==k.statusCode){var c=new Error("CORS request rejected: "+b.uri);return c.cors="rejected",p.loading=!0,p.end=!0,b.callback(c,k)}b.onResponse(null,k)}}function g(){p.loading||(p.loading=!0,a.log.debug("Response body loading",{id:k.id}))}function i(){if(!p.end){if(p.end=!0,a.log.debug("Request done",{id:k.id}),k.body=k.responseText,b.json)try{k.body=JSON.parse(k.responseText)}catch(c){return b.callback(c,k)}b.callback(null,k,k.body)}}var k=new h,l=!1,m=f(b.uri),n="withCredentials"in k;if(j+=1,k.seq_id=j,k.id=j+": "+b.method+" "+b.uri,k._id=k.id,m&&!n){var o=new Error("Browser does not support cross-origin request: "+b.uri);return o.cors="unsupported",b.callback(o,k)}k.timeoutTimer=setTimeout(c,b.timeout);var p={response:!1,loading:!1,end:!1};return k.onreadystatechange=d,k.open(b.method,b.uri,!0),m&&(k.withCredentials=!!b.withCredentials),k.send(b.body),k}function c(){}function d(){var a,b,d={},f=["trace","debug","info","warn","error"];for(b=0;b<f.length;b++)a=f[b],d[a]=c,"undefined"!=typeof console&&console&&console[a]&&(d[a]=e(console,a));return d}function e(a,b){function c(c,d){return"object"==typeof d&&(c+=" "+JSON.stringify(d)),a[b].call(a,c)}return c}function f(a){var b,c=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{b=location.href}catch(d){b=document.createElement("a"),b.href="",b=b.href}var e=c.exec(b.toLowerCase())||[],f=c.exec(a.toLowerCase()),g=!(!f||f[1]==e[1]&&f[2]==e[2]&&(f[3]||("http:"===f[1]?80:443))==(e[3]||("http:"===e[1]?80:443)));return g}function g(a){var b,c,d,e,f,g,h,i,j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",k=0,l=0,m="",n=[];if(!a)return a;do b=a.charCodeAt(k++),c=a.charCodeAt(k++),d=a.charCodeAt(k++),i=b<<16|c<<8|d,e=i>>18&63,f=i>>12&63,g=i>>6&63,h=63&i,n[l++]=j.charAt(e)+j.charAt(f)+j.charAt(g)+j.charAt(h);while(k<a.length);switch(m=n.join(""),a.length%3){case 1:m=m.slice(0,-2)+"==";break;case 2:m=m.slice(0,-1)+"="}return m}var h=XMLHttpRequest;if(!h)throw new Error("missing XMLHttpRequest");a.log={trace:c,debug:c,info:c,warn:c,error:c};var i=18e4,j=0;a.withCredentials=!1,a.DEFAULT_TIMEOUT=i,a.defaults=function(b,c){var d=function(a){var c=function(c,d){c="string"==typeof c?{uri:c}:JSON.parse(JSON.stringify(c));for(var e in b)void 0===c[e]&&(c[e]=b[e]);return a(c,d)};return c},e=d(a);return e.get=d(a.get),e.post=d(a.post),e.put=d(a.put),e.head=d(a.head),e};var k=["get","put","post","head"];return k.forEach(function(b){var c=b.toUpperCase(),d=b.toLowerCase();a[d]=function(b){"string"==typeof b?b={method:c,uri:b}:(b=JSON.parse(JSON.stringify(b)),b.method=c);var d=[b].concat(Array.prototype.slice.apply(arguments,[1]));return a.apply(this,d)}}),a.couch=function(b,d){function e(a,b,c){if(a)return d(a,b,c);if((b.statusCode<200||b.statusCode>299)&&c.error){a=new Error("CouchDB error: "+(c.error.reason||c.error.error));for(var e in c)a[e]=c[e];return d(a,b,c)}return d(a,b,c)}"string"==typeof b&&(b={uri:b}),b.json=!0,b.body&&(b.json=b.body),delete b.body,d=d||c;var f=a(b,e);return f},a})},{}],13:[function(a,b,c){function d(a,b){"object"!=typeof b?b={hash:!!b}:void 0===b.hash&&(b.hash=!0);for(var c=b.hash?{}:"",d=b.serializer||(b.hash?g:h),e=a&&a.elements?a.elements:[],f=Object.create(null),k=0;k<e.length;++k){var l=e[k];if((b.disabled||!l.disabled)&&l.name&&j.test(l.nodeName)&&!i.test(l.type)){var m=l.name,n=l.value;if("checkbox"!==l.type&&"radio"!==l.type||l.checked||(n=void 0),b.empty){if("checkbox"!==l.type||l.checked||(n=""),"radio"===l.type&&(f[l.name]||l.checked?l.checked&&(f[l.name]=!0):f[l.name]=!1),!n&&"radio"==l.type)continue}else if(!n)continue;if("select-multiple"!==l.type)c=d(c,m,n);else{n=[];for(var o=l.options,p=!1,q=0;q<o.length;++q){var r=o[q],s=b.empty&&!r.value,t=r.value||s;r.selected&&t&&(p=!0,c=b.hash&&"[]"!==m.slice(m.length-2)?d(c,m+"[]",r.value):d(c,m,r.value))}!p&&b.empty&&(c=d(c,m,""))}}}if(b.empty)for(var m in f)f[m]||(c=d(c,m,""));return c}function e(a){var b=[],c=/^([^\[\]]*)/,d=new RegExp(k),e=c.exec(a);for(e[1]&&b.push(e[1]);null!==(e=d.exec(a));)b.push(e[1]);return b}function f(a,b,c){if(0===b.length)return a=c;var d=b.shift(),e=d.match(/^\[(.+?)\]$/);if("[]"===d)return a=a||[],Array.isArray(a)?a.push(f(null,b,c)):(a._values=a._values||[],a._values.push(f(null,b,c))),a;if(e){var g=e[1],h=parseInt(g,10);isNaN(h)?(a=a||{},a[g]=f(a[g],b,c)):(a=a||[],a[h]=f(a[h],b,c))}else a[d]=f(a[d],b,c);return a}function g(a,b,c){var d=b.match(k);if(d){var g=e(b);f(a,g,c)}else{var h=a[b];h?(Array.isArray(h)||(a[b]=[h]),a[b].push(c)):a[b]=c}return a}function h(a,b,c){return c=c.replace(/(\r)?\n/g,"\r\n"),c=encodeURIComponent(c),c=c.replace(/%20/g,"+"),a+(a?"&":"")+encodeURIComponent(b)+"="+c}var i=/^(?:submit|button|image|reset|file)$/i,j=/^(?:input|select|textarea|keygen)/i,k=/(\[[^\[\]]*\])/g;b.exports=d},{}]},{},[11]);